{%extends 'base.html'%}
{%block title%}Table{%endblock%}
{%block content%}
<h3>Table</h3>
<div class="card">
    <div class="card-content">
        Table {{table.number}}, {{table.name}}, seated at {{table.dtg}}
        <div class="row">
        {%if table.orders.count %}
            {%for order in table.orders.all %}
            <div class="card">
                <div class="card-header">Seat: <span class="seat{{order.id}}">{{order.seat}}</span></div>
                <div class="card-content">
                    {%for item in order.items.all %}
                        <p class="item{{order.id}}" id={{item.id}}>{{item.name}}</p>
                    {%endfor%}
                    <p>Subtotal: ${{order.subtot}}</p>
                <div class="card-action">
                    <button data-target="modal{{order.id}}" class="btn modal-trigger order-modal" id="{{order.id}}">Edit Order</button>
                </div>
                </div>
            </div>    
            <div class="modal" id='modal{{order.id}}'>
                <div class="modal-content">
                    <h6>Edit Order</h6>
                    <form action="/tables/{{table.id}}/orders/{{order.id}}/update" method="post" id="form{{order.id}}">
                        {%csrf_token%}
                        {{form.as_p}}
                        <input type="submit" class="modal-close btn-flat" value="Update">
                    </form>
                </div>
            </div> 
            {%endfor%}
        {% else %}
            <p>No Orders</p>
        {%endif%}
        </div>
        <h6>Subtotal: ${{table.subtot}}</h6>
        <h6>Tax: ${{table.tax}}</h6>
        <h5>Total: ${{table.bill}}</h5>
        <p>Suggested Gratuity:</p>
        <small>15%: {{table.grat15}}</small> | <small>18%: {{table.grat18}}</small> | <small>20%: {{table.grat20}}</small>
    </div>
    <div class="card-action">
        <button data-target="modalbot" class="btn modal-trigger">Add Order</button>
        <a href="" class="btn">Close Table</a>
    </div>
    <div class="modal" id="modalbot">
        <div class="modal-content">
            <h4>Add Order</h4>
            <form action="/tables/{{table.id}}/orders/new" method="post">
                {%csrf_token%}
                {{form.as_p}}
                <input type="submit" class="modal-close btn-flat" value="Add Order">
            </form>
        </div>
    </div>
</div>
{%endblock%}